'From Pharo10.0.0 of 15 February 2022 [Build information: Pharo-10.0.0+build.442.sha.a1ff670e34e2d4f0aeb50748cae86f25dcc133b2 (64 Bit)] on 1 March 2022 at 9:44:33.879337 am'!Object subclass: #AEDStore	instanceVariableNames: 'items'	classVariableNames: 'Default'	package: 'AA-RestTuto'!!AEDStore commentStamp: 'cd 2/17/2022 12:01' prior: 0!I keep a selection of AED and allow to load them from a CSV file.Example:```	self default loadFromFile: FileLocator home / 'dev' / 'rmod' / '2022-rest-tutorial' / 'aed_csv' / 'data.csv'.```!!AEDStore methodsFor: 'inspecting' stamp: 'cd 2/18/2022 10:01'!inspectionItems: aBuilder	<inspectorPresentationOrder: 0 title: 'AED'> 		^ aBuilder newTable		addColumn: (SpStringTableColumn new 			title: 'Index';			evaluated: [ :each | each id ];			beNotExpandable;			yourself);		addColumn: (SpStringTableColumn new 			title: 'Latitude';			evaluated: [ :each | each latitude ];			beNotExpandable;			yourself);		addColumn: (SpStringTableColumn new  			title: 'Longitude';			beNotExpandable;			evaluated: [ :each | each longitude ];			yourself);		addColumn: (SpStringTableColumn new 			title: 'City';			evaluated: [ :each | each city ];			sortFunction: #city ascending;			yourself);		addColumn: (SpCheckBoxTableColumn new 			title: 'Free access';			evaluated: [ :each | each freeAccess ];			sortFunction: #freeAccess ascending;			yourself);		addColumn: (SpStringTableColumn new  			title: 'Access info'; 			evaluated: [ :each | each accessInfo ];			yourself);		items: items asOrderedCollection;		yourself! !!AEDStore methodsFor: 'initialization' stamp: 'cd 2/18/2022 11:28'!loadFromFile: csvFileReference	| records |	records := self cleanData: csvFileReference contents withInternalLineEndings lines copyWithoutFirst.	self items: (records collect: [ :record | self aedFromRecord: record ]).	^ self	! !!AEDStore methodsFor: 'accessing' stamp: 'cd 2/18/2022 10:01'!items: aListOfAED	items := aListOfAED.	self assignIds.! !!AEDStore methodsFor: 'accessing' stamp: 'cd 2/17/2022 11:54'!items	^ items! !!AEDStore methodsFor: 'initialization - private' stamp: 'cd 2/17/2022 11:57'!cleanData: lines	"One AED information can be splitted on many lines (description with line breaks). Let's uniformize the content."	| records |		records := OrderedCollection new: lines size.	lines do: [ :line | 		(line first isDigit or: [ line first = $- ])			ifTrue: [ records add: line ]			ifFalse: [ records atLast: 1 put: records last , line ] ].	^ records! !!AEDStore methodsFor: 'initialization - private' stamp: 'cd 2/17/2022 12:18'!aedFromRecord: aRecord	| fields |	fields := $; split: aRecord.	^ AED new		latitude: (fields at: 5);		longitude: (fields at: 6);		city: (fields at: 11);		freeAccess:  (fields at: 13) = 'oui';		accessInfo: (fields at: 17);		yourself.! !!AEDStore methodsFor: 'initialization - private' stamp: 'cd 2/18/2022 10:02'!assignIds	items withIndexDo: [ :item : index |		item id: index ]! !!AEDStore methodsFor: 'removing' stamp: 'cd 2/28/2022 11:06'!removeAedWithId: anId	^ self items remove: (self aedWithId: anId)! !!AEDStore methodsFor: 'finding' stamp: 'cd 2/28/2022 11:06'!aedWithId: anId	^ self items detect: [ :aed | aed id = anId ]! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!AEDStore class	instanceVariableNames: ''!!AEDStore class methodsFor: 'accessing' stamp: 'cd 2/17/2022 11:56'!default	^ Default ifNil: [ Default := self new ]! !!AEDStore class methodsFor: 'accessing' stamp: 'cd 2/17/2022 11:46'!load	self loadFromFile: FileLocator home / 'dev' / 'rmod' / '2022-rest-tutorial' / 'aed_csv' / 'data.csv'.! !